# CherryAI 종합 테스트 계획 (Comprehensive Test Plan)

## 프로젝트 핵심 철학 준수 사항

### 🎯 LLM First 원칙 (절대적 핵심)
- LLM의 능력을 최대한으로 끌어내서 범용적으로 동작
- Rule 기반 하드코딩 절대 금지
- 템플릿이나 패턴 매칭 지양
- 모든 분석과 응답은 LLM의 자연어 이해능력 활용

### 🏗️ 아키텍처 표준 준수
- A2A SDK 0.2.9 표준 완전 준수
- SSE(Server-Sent Events) 실시간 스트리밍 필수
- ASYNC 방식으로 모든 통신 처리
- 18개 컴포넌트 완전 통합 (11개 A2A 에이전트 + 7개 MCP 도구)

## 테스트 대상 시스템 구성

### A2A 에이전트 (11개)
1. **a2a_orchestrator** - 메인 오케스트레이터
2. **pandas_data_analyst** - 데이터 분석 전문가
3. **intelligent_data_handler** - 지능형 데이터 처리
4. **natural_language_processor** - 자연어 처리
5. **multi_dataframe_handler** - 다중 데이터프레임 관리
6. **agent_persona_manager** - 에이전트 페르소나 관리
7. **collaboration_rules_engine** - 협업 규칙 엔진
8. **data_validator** - 데이터 검증
9. **feature_engineering** - 피처 엔지니어링
10. **ml_model_trainer** - 머신러닝 모델 학습
11. **result_formatter** - 결과 포맷팅

### MCP 도구 (7개)
1. **mcp_datacleaning_agent** - 데이터 정제
2. **mcp_dataloader_agent** - 데이터 로딩
3. **mcp_datavisualization_agent** - 데이터 시각화
4. **mcp_datawrangling_agent** - 데이터 랭글링
5. **mcp_eda_agent** - 탐색적 데이터 분석
6. **mcp_featureengineering_agent** - 피처 엔지니어링
7. **mcp_sqldatabase_agent** - SQL 데이터베이스

## 테스트 단계별 계획

## Phase 1: 단위 기능 테스트 (Unit Tests with pytest)

### 1.1 Core 모듈 테스트
- **MainAppController**: 시스템 상태 관리, 세션 관리, 에러 처리
- **RealtimeStreamingHandler**: 실시간 스트리밍, 청킹, 성능 최적화
- **FileUploadProcessor**: 파일 검증, 인코딩 감지, A2A 포맷 변환
- **SystemStatusMonitor**: 서비스 모니터링, 헬스체크, 성능 메트릭

### 1.2 A2A 통신 테스트
- A2A SDK 0.2.9 표준 준수 검증
- 메시지 포맷 호환성 (kind/type 필드)
- TaskUpdater 정확한 사용법
- Part 객체 접근 (part.root.kind, part.root.text)

### 1.3 MCP 통합 테스트
- MCP SSE 도구 연결 상태
- MCP STDIO 도구 프로세스 관리
- 메시지 라우팅 정확성

## Phase 2: 통합 테스트 (Integration Tests with pytest)

### 2.1 UnifiedMessageBroker 테스트
- A2A ↔ MCP 메시지 라우팅
- 실시간 스트리밍 통합
- 오류 복구 메커니즘

### 2.2 다중 에이전트 협업 테스트
- 11개 A2A 에이전트 간 협업
- 7개 MCP 도구와의 연동
- 메시지 흐름 추적

### 2.3 데이터 파이프라인 테스트
- 파일 업로드 → 처리 → 분석 → 결과 생성
- 다양한 파일 포맷 (CSV, Excel, JSON)
- 인코딩 호환성 (UTF-8, CP949, Latin-1)

## Phase 3: E2E UI 테스트 (Playwright MCP)

### 3.1 사용자 시나리오 테스트
1. **데이터 업로드 시나리오**
   - CSV 파일 업로드
   - Excel 파일 업로드
   - JSON 파일 업로드
   - 잘못된 파일 포맷 오류 처리

2. **데이터 분석 시나리오**
   - 기본 통계 분석 요청
   - 시각화 생성 요청
   - 머신러닝 모델링 요청
   - 복합 분석 요청

3. **실시간 스트리밍 시나리오**
   - 타이핑 인디케이터 확인
   - 청크 단위 응답 확인
   - 100ms 버퍼링 성능 확인

### 3.2 답변 퀄리티 평가 기준

#### 3.2.1 LLM First 원칙 준수 평가
- **범용성**: 특정 데이터셋에 특화되지 않고 일반적으로 적용 가능한가?
- **자연어 이해**: 사용자 요청의 의도를 정확히 파악했는가?
- **적응성**: 다양한 데이터 구조와 분석 요구에 유연하게 대응하는가?

#### 3.2.2 기술적 정확성 평가
- **데이터 처리**: 데이터 타입, 결측값, 이상값 처리가 적절한가?
- **분석 방법**: 요청에 맞는 적절한 분석 기법을 선택했는가?
- **결과 해석**: 분석 결과에 대한 설명이 정확하고 이해하기 쉬운가?

#### 3.2.3 사용자 경험 평가
- **응답 속도**: 실시간 스트리밍이 원활하게 작동하는가?
- **시각화**: 데이터 시각화가 직관적이고 유의미한가?
- **상호작용**: 후속 질문에 대한 대화형 응답이 자연스러운가?

### 3.3 테스트 데이터셋 준비
1. **타이타닉 데이터셋** (분류 문제)
2. **보스턴 주택가격 데이터셋** (회귀 문제)
3. **아이리스 데이터셋** (기본 EDA)
4. **시계열 데이터** (날짜/시간 분석)
5. **텍스트 데이터** (자연어 처리)

## Phase 4: 성능 및 안정성 테스트

### 4.1 성능 테스트
- 대용량 파일 처리 (1MB+)
- 다중 사용자 동시 접속
- 메모리 사용량 모니터링
- 응답 시간 측정

### 4.2 안정성 테스트
- 네트워크 연결 끊김 시 복구
- 서버 재시작 시 상태 복원
- 오류 상황에서의 graceful degradation

## 오류 처리 및 개선 방침

### 근본 원인 분석 (RCA) 절차
1. **현상 파악**: 정확한 오류 메시지와 재현 단계 문서화
2. **로그 분석**: A2A, MCP, Streamlit 로그 종합 분석
3. **아키텍처 검토**: LLM First 원칙과 A2A 표준 준수 여부 확인
4. **근본 원인 식별**: 임시방편이 아닌 구조적 문제 파악
5. **개선 방안 수립**: 재발 방지를 위한 시스템 개선

### 개선 우선순위
1. **LLM First 원칙 위반** - 최우선 수정
2. **A2A 표준 미준수** - 즉시 수정
3. **사용자 경험 저하** - 신속 개선
4. **성능 최적화** - 단계적 개선

## 테스트 성공 기준

### 기능적 요구사항
- [ ] 18개 모든 컴포넌트 정상 작동
- [ ] 실시간 스트리밍 100% 작동
- [ ] 파일 업로드/처리 100% 성공
- [ ] 모든 테스트 케이스 통과 (95% 이상)

### 품질 요구사항
- [ ] LLM First 원칙 100% 준수
- [ ] A2A SDK 0.2.9 표준 100% 준수
- [ ] 사용자 만족도 평가 (답변 퀄리티) 85% 이상
- [ ] 응답 시간 3초 이내 (첫 응답 기준)

### 안정성 요구사항
- [ ] 24시간 연속 운영 테스트 통과
- [ ] 오류 복구율 99% 이상
- [ ] 메모리 누수 없음
- [ ] 데이터 무결성 100% 보장

## 테스트 결과 문서화

### 테스트 보고서 구성
1. **Executive Summary**: 전체 테스트 결과 요약
2. **Detailed Results**: 단계별 상세 결과
3. **Quality Assessment**: 답변 퀄리티 정량/정성 평가
4. **Issue Analysis**: 발견된 이슈와 근본 원인 분석
5. **Improvement Recommendations**: 개선 권장사항
6. **Performance Metrics**: 성능 지표 및 벤치마크

### 지속적 개선
- 테스트 자동화 파이프라인 구축
- 회귀 테스트 프레임워크 개발
- 사용자 피드백 수집 체계 구축
- 모니터링 및 알럿 시스템 개선 