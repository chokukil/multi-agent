# ğŸš€ CherryAI Advanced Enhancement Implementation Plan

## ğŸ“‹ **í˜„ì¬ ì§„í–‰ ìƒí™© ë° ê°œì„  ê³„íš**

### ğŸ¯ **Phase 1: Shared Knowledge Bank ê³ ê¸‰ ì„ë² ë”© ê²€ìƒ‰ ì‹œìŠ¤í…œ**

#### **1.1 ê¸°ìˆ  ìŠ¤íƒ ì„ ì •**
- **ë²¡í„° DB**: ChromaDB (ë¡œì»¬ ê°œë°œ ìµœì í™”, Python-first)
- **ì„ë² ë”© ëª¨ë¸**: Sentence-BERT (all-MiniLM-L6-v2) - ë¹ ë¥¸ ë¡œì»¬ ì²˜ë¦¬
- **ê²€ìƒ‰ ì „ëµ**: í•˜ì´ë¸Œë¦¬ë“œ (Dense + Sparse) ê²€ìƒ‰
- **ì²­í‚¹ ì „ëµ**: Context-aware ì²­í‚¹ (500-1000 í† í°)

#### **1.2 í•µì‹¬ êµ¬í˜„ ìš”ì†Œ**
```python
- AdvancedSharedKnowledgeBank: ë©”ì¸ í´ë˜ìŠ¤
- KnowledgeType: FILE_DATA, AGENT_MEMORY, USER_QUERY, ANALYSIS_RESULT
- SearchStrategy: SEMANTIC, KEYWORD, HYBRID, CONTEXTUAL
- ì‹¤ì‹œê°„ ì§€ì‹ ë™ê¸°í™” ë° A2A ì—ì´ì „íŠ¸ë³„ ë¶„í• 
```

#### **1.3 A2A í†µí•©**
- Context Engineering 6 Data Layersì™€ ì™„ì „ í†µí•©
- ì—ì´ì „íŠ¸ ê°„ ì§€ì‹ ê³µìœ  ìë™í™”
- ë©”íƒ€ë°ì´í„° enrichment

---

## ğŸ§  **Phase 2: LLM First ì›ì¹™ ì™„ì „ ì¤€ìˆ˜**

### **2.1 í•µì‹¬ ì›ì¹™**
- âŒ **ì ˆëŒ€ ê¸ˆì§€**: Rule ê¸°ë°˜ í•˜ë“œì½”ë”©, íŒ¨í„´ ë§¤ì¹­, í…œí”Œë¦¿ ë§¤ì¹­
- âœ… **í•„ìˆ˜ ì¤€ìˆ˜**: LLM ëŠ¥ë ¥ ìµœëŒ€ í™œìš©, ë²”ìš©ì  ë™ì‘, ì‚¬ìš©ì ì˜ë„ ë°˜ì˜
- âœ… **A2A í‘œì¤€**: SDK 0.2.9, SSE ìŠ¤íŠ¸ë¦¬ë°, ASYNC ë°©ì‹

### **2.2 í•˜ë“œì½”ë”© ì œê±° ëŒ€ìƒ**
1. **íŠ¹ì • ë°ì´í„°ì…‹ ì „ìš© ë¡œì§** (íƒ€ì´íƒ€ë‹‰, ì•„ì´ë¦¬ìŠ¤ ë“±)
2. **ê³ ì •ëœ ì»¬ëŸ¼ëª… ì°¸ì¡°** ('Survived', 'Sex', 'Pclass' ë“±)
3. **Rule ê¸°ë°˜ ë°ì´í„° íƒ€ì… íŒë‹¨**
4. **íŒ¨í„´ ë§¤ì¹­ ê¸°ë°˜ ì¿¼ë¦¬ ì²˜ë¦¬**

### **2.3 LLM First êµ¬í˜„ ë°©ì‹**
```python
# âŒ í•˜ë“œì½”ë”© ë°©ì‹
if 'Survived' in columns:
    return classification_analysis()

# âœ… LLM First ë°©ì‹  
context = f"ë°ì´í„° ì»¬ëŸ¼: {columns}, ì‚¬ìš©ì ìš”ì²­: {user_query}"
analysis_type = await llm.determine_analysis_type(context)
return await llm.generate_analysis(data, analysis_type, user_query)
```

---

## ğŸ§ª **Phase 3: ì²´ê³„ì  í…ŒìŠ¤íŠ¸ ì „ëµ**

### **3.1 í…ŒìŠ¤íŠ¸ ê³„ì¸µ**

#### **Level 1: ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ (pytest)**
```bash
# ê°œë³„ ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸
pytest tests/unit/test_shared_knowledge_bank.py
pytest tests/unit/test_llm_first_compliance.py
pytest tests/unit/test_a2a_agents.py
pytest tests/unit/test_mcp_tools.py
```

#### **Level 2: í†µí•© í…ŒìŠ¤íŠ¸ (pytest)**
```bash
# ì»´í¬ë„ŒíŠ¸ ê°„ ìƒí˜¸ì‘ìš© í…ŒìŠ¤íŠ¸
pytest tests/integration/test_a2a_mcp_integration.py
pytest tests/integration/test_knowledge_bank_integration.py
pytest tests/integration/test_streaming_integration.py
```

#### **Level 3: E2E í…ŒìŠ¤íŠ¸ (Playwright MCP)**
```bash
# ì‹¤ì œ UI ë° ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸
- ë°ì´í„° ì—…ë¡œë“œ â†’ ë¶„ì„ â†’ ê²°ê³¼ í™•ì¸
- A2A ì—ì´ì „íŠ¸ ì²´ì¸ ì‹¤í–‰
- MCP ë„êµ¬ ì—°ë™ ê²€ì¦
- ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë° ê²€ì¦
```

### **3.2 ê²€ì¦ ê¸°ì¤€**

#### **ê¸°ëŠ¥ì  ê²€ì¦**
- âœ… ëª¨ë“  A2A ì—ì´ì „íŠ¸ (11ê°œ) ì •ìƒ ë™ì‘
- âœ… ëª¨ë“  MCP ë„êµ¬ (7ê°œ) ì—°ë™ ì„±ê³µ
- âœ… ì‹¤ì‹œê°„ SSE ìŠ¤íŠ¸ë¦¬ë° ì •ìƒ
- âœ… ì§€ì‹ ë±…í¬ ì„ë² ë”© ê²€ìƒ‰ ì •í™•ë„

#### **í’ˆì§ˆì  ê²€ì¦**
- âœ… ê²°ê³¼ì˜ ì •í™•ì„± (ì…ë ¥ ëŒ€ë¹„ ì ì ˆí•œ ë¶„ì„)
- âœ… LLM First ì›ì¹™ ì¤€ìˆ˜ (í•˜ë“œì½”ë”© 0%)
- âœ… ì‘ë‹µ ì‹œê°„ (<500ms)
- âœ… ì˜¤ë¥˜ ë³µêµ¬ ëŠ¥ë ¥

---

## ğŸ—ï¸ **Phase 4: main.py ëª¨ë“ˆí™” ì „ëµ**

### **4.1 í˜„ì¬ main.py ë¶„ì„**
- í¬ê¸°: ~500 ë¼ì¸ (ì„ê³„ì  ê·¼ì ‘)
- ë¬¸ì œ: UI ë¡œì§ê³¼ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ í˜¼ì¬
- í•´ê²°: ì»´í¬ë„ŒíŠ¸ ê¸°ë°˜ ëª¨ë“ˆ ë¶„ë¦¬

### **4.2 ëª¨ë“ˆ ë¶„ë¦¬ ê³„íš**
```python
main.py                     # ì§„ì…ì ë§Œ (50 ë¼ì¸ ì´í•˜)
â”œâ”€â”€ ui/main_ui_controller.py     # UI ì»¨íŠ¸ë¡¤ëŸ¬
â”œâ”€â”€ core/main_app_engine.py      # ë¹„ì¦ˆë‹ˆìŠ¤ ì—”ì§„  
â”œâ”€â”€ core/main_config_manager.py  # ì„¤ì • ê´€ë¦¬
â””â”€â”€ core/main_session_manager.py # ì„¸ì…˜ ê´€ë¦¬
```

### **4.3 ì˜ì¡´ì„± ì£¼ì… íŒ¨í„´**
- ê° ëª¨ë“ˆì€ ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
- Interface ê¸°ë°˜ loose coupling
- Factory íŒ¨í„´ìœ¼ë¡œ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±

---

## ğŸ¯ **Phase 5: ì‹¤í–‰ ìˆœì„œ**

### **Step 1: ë¬¸ì„œí™” ë° ê³„íš ìˆ˜ë¦½** âœ…
- í˜„ì¬ ë‹¨ê³„ ì™„ë£Œ

### **Step 2: Shared Knowledge Bank ì™„ì„±**
```bash
1. ChromaDB ì˜ì¡´ì„± ì„¤ì¹˜
2. ê³ ê¸‰ ì„ë² ë”© ê²€ìƒ‰ êµ¬í˜„
3. A2A í†µí•© í…ŒìŠ¤íŠ¸
4. ì„±ëŠ¥ ìµœì í™”
```

### **Step 3: LLM First ê°œì„ **
```bash
1. í•˜ë“œì½”ë”© ê°ì§€ ë° ì œê±°
2. LLM ê¸°ë°˜ ë™ì  ë¶„ì„ ë¡œì§
3. ë²”ìš©ì  ë°ì´í„° ì²˜ë¦¬ ì—”ì§„
4. ê²€ì¦ í…ŒìŠ¤íŠ¸
```

### **Step 4: main.py ëª¨ë“ˆí™”**
```bash
1. ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬
2. Interface ì •ì˜
3. ì˜ì¡´ì„± ì£¼ì… êµ¬í˜„
4. í†µí•© í…ŒìŠ¤íŠ¸
```

### **Step 5: ì¢…í•© í…ŒìŠ¤íŠ¸**
```bash
1. pytest ë‹¨ìœ„/í†µí•© í…ŒìŠ¤íŠ¸
2. Playwright MCP E2E í…ŒìŠ¤íŠ¸
3. ì„±ëŠ¥ ë° í’ˆì§ˆ ê²€ì¦
4. ìµœì¢… ë¬¸ì„œí™”
```

---

## ğŸ” **í…ŒìŠ¤íŠ¸ ë§¤íŠ¸ë¦­ìŠ¤**

| ì»´í¬ë„ŒíŠ¸ | ë‹¨ìœ„í…ŒìŠ¤íŠ¸ | í†µí•©í…ŒìŠ¤íŠ¸ | E2Eí…ŒìŠ¤íŠ¸ | í’ˆì§ˆê²€ì¦ |
|----------|-----------|----------|----------|----------|
| **A2A ì—ì´ì „íŠ¸ (11ê°œ)** | pytest | pytest | Playwright | LLM í‰ê°€ |
| **MCP ë„êµ¬ (7ê°œ)** | pytest | pytest | Playwright | ê²°ê³¼ ê²€ì¦ |
| **Shared Knowledge Bank** | pytest | pytest | Playwright | ê²€ìƒ‰ ì •í™•ë„ |
| **ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë°** | pytest | pytest | Playwright | ì§€ì—°ì‹œê°„ |
| **UI ì»´í¬ë„ŒíŠ¸** | - | pytest | Playwright | UX ê²€ì¦ |
| **LLM First ì¤€ìˆ˜** | pytest | pytest | Playwright | í•˜ë“œì½”ë”© 0% |

---

## ğŸ“Š **ì„±ê³µ ê¸°ì¤€**

### **í•„ìˆ˜ ê¸°ì¤€**
- [ ] ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼ìœ¨ 95% ì´ìƒ
- [ ] í•˜ë“œì½”ë”© íŒ¨í„´ 0ê°œ ê²€ì¶œ
- [ ] ì‘ë‹µ ì‹œê°„ 500ms ì´í•˜
- [ ] ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìµœì í™”

### **í’ˆì§ˆ ê¸°ì¤€**  
- [ ] ë¶„ì„ ê²°ê³¼ ì •í™•ë„ 90% ì´ìƒ
- [ ] ì‚¬ìš©ì ì˜ë„ ë°˜ì˜ë„ 95% ì´ìƒ
- [ ] A2A ì—ì´ì „íŠ¸ ì²´ì¸ ì„±ê³µë¥  98% ì´ìƒ
- [ ] ì§€ì‹ ë±…í¬ ê²€ìƒ‰ ì •í™•ë„ 85% ì´ìƒ

---

## ğŸš¨ **ì£¼ì˜ì‚¬í•­**

1. **Playwright MCP ì—°ê²° ì‹¤íŒ¨ì‹œ**:
   - MCP ì„œë²„ ë¹„í™œì„±í™” â†’ ëŒ€ê¸° â†’ ì¬í™œì„±í™”
   - ì ˆëŒ€ ë‹¤ë¥¸ ëŒ€ì•ˆ ë„êµ¬ ì‚¬ìš© ê¸ˆì§€

2. **ì˜¤ë¥˜ ë°œìƒì‹œ**:
   - ì¦ìƒ í•´ê²°ë³´ë‹¤ ê·¼ë³¸ ì›ì¸ íŒŒì•… ìš°ì„ 
   - LLM First ì›ì¹™ ìœ„ë°˜ ì—¬ë¶€ í™•ì¸
   - ì„ì‹œë°©í¸ ì†”ë£¨ì…˜ ì ˆëŒ€ ê¸ˆì§€

3. **í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ì‹œ**:
   - ë‹¨ìˆœ í†µê³¼ë³´ë‹¤ ê²°ê³¼ í’ˆì§ˆ ì¤‘ìš”
   - ì‚¬ìš©ì ê´€ì ì—ì„œ ì •í™•ì„± ê²€ì¦
   - A2A + MCP í†µí•© ì²´ì¸ ì „ì²´ ê²€ì¦

---

**ğŸ“ ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2024-01-20
**ğŸ“‹ ë‹´ë‹¹ì**: CherryAI Development Team
**ğŸ¯ ëª©í‘œ**: ì„¸ê³„ ìµœì´ˆ A2A + MCP + Enterprise LLM First í”Œë«í¼ ì™„ì„± 